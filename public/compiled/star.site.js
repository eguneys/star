(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Star = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

require("./standalones/util");

require("./standalones/trans");

require("./socket");

require("./main");

},{"./main":2,"./socket":3,"./standalones/trans":4,"./standalones/util":5}],2:[function(require,module,exports){
"use strict";

(function () {})();

},{}],3:[function(require,module,exports){
"use strict";

function makeAckable(send) {
  var currentId = 1;
  var messages = [];

  function resend() {
    var resendCutoff = Date.now() - 2500;
    messages.forEach(function (m) {
      if (m.at < resendCutoff) send(m.t, m.d);
    });
  }

  setInterval(resend, 1000);
  return {
    resend: resend,
    register: function register(t, d) {
      d.a = currentId++;
      messages.push({
        t: t,
        d: d,
        at: Date.now()
      });
    },
    gotAck: function gotAck(id) {
      messages = messages.filter(function (m) {
        return m.d.a !== id;
      });
    }
  };
}

star.StrongSocket = function (url, version, settings) {
  var now = Date.now;
  settings = $.extend(true, {}, star.StrongSocket.defaults, settings);
  var options = settings.options;
  var ws;
  var pingSchedule;
  var connectSchedule;
  var ackable = makeAckable(function (t, d) {
    send(t, d);
  });
  var lastPingTime = now();
  var pongCount = 0;
  var _averageLag = 0;
  var tryOtherUrl = false;
  var autoReconnect = true;
  var nbConnects = 0;
  var storage = star.storage.make('surl6');

  var connect = function connect() {
    destroy();
    autoReconnect = true;
    var params = $.param(settings.params);
    if (version !== false) params += (params ? '&' : '') + 'v=' + version;
    var fullUrl = options.protocol + '//' + baseUrl() + url + '?' + params;
    debug("connection attempt to " + fullUrl);

    try {
      ws = new WebSocket(fullUrl);

      ws.onerror = function (e) {
        onError(e);
      };

      ws.onclose = function (e) {
        if (autoReconnect) {
          debug("Will autoreconnect in " + options.autoReconnectDelay);
          scheduleConnect(options.autoReconectDelay);
        }
      };

      ws.onopen = function () {
        debug("connected to " + fullUrl);
        onSuccess();
        $("body").removeClass("offline").addClass("online");
        pingNow();
        ackable.resend();
      };

      ws.onmessage = function (e) {
        if (e.data === 0) {
          pong();
          return;
        }

        var m = JSON.parse(e.data);
        if (m.t === 'n') pong();
        if (m.t === 'b') m.d.forEach(handle);else handle(m);
      };
    } catch (e) {
      onError(e);
    }

    scheduleConnect(options.pingMaxLag);
  };

  var send = function send(t, d, o, noRetry) {
    o = o || {};
    var msg = {
      t: t
    };

    if (d !== undefined) {
      if (o.withLag) d.l = Math.round(_averageLag);
      if (o.millis >= 0) d.s = Math.round(o.millis * 0.1).toString(36);
      msg.d = d;
    }

    if (o.ackable) {
      msg.d = msg.d || {};
      ackable.register(t, msg.d);
    }

    var message = JSON.stringify(msg);
    debug("send " + message);

    try {
      ws.send(message);
    } catch (e) {
      if (!noRetry) setTimeout(function () {
        send(t, msg.d, o, true);
      }, 1000);
    }
  };

  var scheduleConnect = function scheduleConnect(delay) {
    if (options.idle) delay = 10 * 1000 + Math.random() * 10 * 1000;
    clearTimeout(pingSchedule);
    clearTimeout(connectSchedule);
    connectSchedule = setTimeout(function () {
      $('body').addClass('offline').removeClass('online');
      tryOtherUrl = true;
      connect();
    }, delay);
  };

  var schedulePing = function schedulePing(delay) {
    clearTimeout(pingSchedule);
    pingSchedule = setTimeout(pingNow, delay);
  };

  var pingNow = function pingNow() {
    clearTimeout(pingSchedule);
    clearTimeout(connectSchedule);
    var pingData = options.isAuth && pongCount % 8 == 2 ? JSON.stringify({
      t: 'p',
      l: Math.round(0.1 * _averageLag),
      v: version
    }) : null;

    try {
      ws.send(pingData);
      lastPingTime = now();
    } catch (e) {
      debug(e, true);
    }

    scheduleConnect(options.pingMaxLag);
  };

  var computePingDelay = function computePingDelay() {
    return options.pingDelay + (options.idle ? 1000 : 0);
  };

  var pong = function pong() {
    clearTimeout(connectSchedule);
    schedulePing(computePingDelay());
    var currentLag = Math.min(now() - lastPingTime, 10000);
    pongCount++;
    var mix = pongCount > 4 ? 0.1 : 1 / pongCount;
    _averageLag += mix * (currentLag - _averageLag);
  };

  var handle = function handle(m) {
    if (m.v) {
      if (m.v <= version) {
        debug("already has event " + m.v);
        return;
      }

      if (m.v > version + 1) {
        star.reload();
        return;
      }

      version = m.v;
    }

    switch (m.t || false) {
      case false:
        break;

      case 'resync':
        star.reload();
        break;

      case 'ack':
        ackable.gotAck(m.d);
        break;

      default:
        var processed = settings.receive && settings.receive(m.t, m.d);
        if (!processed && settings.events[m.t]) settings.events[m.t](m.d || null, m);
    }
  };

  var debug = function debug(msg, always) {
    if (always || options.debug) {
      console.debug("[" + options.name + " " + settings.params.sri + "]", msg);
    }
  };

  var destroy = function destroy() {
    clearTimeout(pingSchedule);
    clearTimeout(connectSchedule);
    disconnect();
    ws = null;
  };

  var disconnect = function disconnect(onNextConnect) {
    if (ws) {
      debug("Disconnect");
      autoReconnect = false;
      ws.onerror = ws.onclose = ws.onopen = ws.onmessage = $.noop;
      ws.close();
    }

    if (onNextConnect) options.onNextConnect = onNextConnect;
  };

  var onError = function onError(e) {
    options.debug = true;
    debug('error: ' + JSON.stringify(e));
    tryOtherUrl = true;
    clearTimeout(pingSchedule);
  };

  var onSuccess = function onSuccess() {
    nbConnects++;

    if (nbConnects === 1) {
      options.onFirstConnect();
    }
  };

  var baseUrl = function baseUrl() {
    var urls = options.baseUrls,
        url = storage.get();

    if (!url) {
      url = urls[0];
      storage.set(url);
    } else if (tryOtherUrl) {
      tryOtherUrl = false;
      url = urls[(urls.indexOf(url) + 1) % urls.length];
      storage.set(url);
    }

    return url;
  };

  connect();
  window.addEventListener('unload', destroy);
  return {
    connect: connect,
    disconnect: disconnect,
    send: send,
    destroy: destroy,
    options: options,
    pingInterval: function pingInterval() {
      return computePingInterval() + _averageLag;
    },
    averageLag: function averageLag() {
      return _averageLag;
    },
    getVersion: function getVersion() {
      return version;
    }
  };
};

star.StrongSocket.sri = Math.random().toString(36).slice(2, 12);
star.StrongSocket.defaults = {
  events: {},
  params: {
    sri: star.StrongSocket.sri
  },
  options: {
    name: 'unnamed',
    idle: false,
    pingMaxLag: 9000,
    pingDelay: 2500,
    autoReconnectDelay: 3500,
    protocol: location.protocol === 'https:' ? 'wss:' : 'ws:',
    baseUrls: function (d) {
      return [d].concat((d === 'socket.oyunkeyf.net' || d === 'socket.o.com' ? [1, 2, 5, 6] : []).map(function (port) {
        return d + ':' + (9020 + port);
      }));
    }(document.body.getAttribute('data-socket-domain')),
    onFirstConnect: $.noop
  }
};

},{}],4:[function(require,module,exports){
"use strict";

star.trans = function (i18n) {
  var format = function format(str, args) {
    if (args.length && str.includes('$s')) for (var i = 1; i < 4; i++) {
      str = str.replace('%' + i + '$s', args[i - 1]);
    }
    args.forEach(function (arg) {
      str = str.replace('%s', arg);
    });
    return str;
  };

  var list = function list(str, args) {
    var segments = str.split(/(%(?:\d\$)?s)/g);

    for (var i = 1; i <= args.length; i++) {
      var pos = segments.indexOf('%' + i + '$s');
      if (pos !== -1) segments[pos] = args[i - 1];
    }

    for (var i = 0; i < args.length; i++) {
      var pos = segments.indexOf('%s');
      if (pos === -1) break;
      segments[pos] = args[i];
    }

    return segments;
  };

  var trans = function trans(key) {
    var str = i18n[key];
    return str ? format(str, Array.prototype.slice.call(arguments, 1)) : key;
  };

  trans.noarg = function (key) {
    // optimisation for translations without arguments
    return i18n[key] || key;
  };

  trans.vdom = function (key) {
    var str = i18n[key];
    return str ? list(str, Array.prototype.slice.call(arguments, 1)) : [key];
  };

  return trans;
};

},{}],5:[function(require,module,exports){
"use strict";

window.star = window.star || {};

star.storage = function () {
  var storage = window.localStorage;
  var api = {
    get: function get(k) {
      return storage.getItem(k);
    },
    set: function set(k, v) {
      storage.setItem(k, v);
    },
    remove: function remove(k) {
      storage.removeItem(k);
    },
    make: function make(k) {
      return {
        get: function get() {
          return api.get(k);
        },
        set: function set(v) {
          api.set(k, v);
        },
        remove: function remove() {
          api.remove(k);
        },
        listen: function listen(f) {
          window.addEventListener('storage', function (e) {
            if (e.key === k && e.storageArea === storage && e.newValue !== null) f(e);
          });
        }
      };
    }
  };
  return api;
}();

},{}]},{},[1])(1)
});

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvaW5kZXguanMiLCJzcmMvbWFpbi5qcyIsInNyYy9zb2NrZXQuanMiLCJzcmMvc3RhbmRhbG9uZXMvdHJhbnMuanMiLCJzcmMvc3RhbmRhbG9uZXMvdXRpbC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7O0FDSEEsQ0FBQyxZQUFXLENBRVgsQ0FGRDs7Ozs7QUNBQSxTQUFTLFdBQVQsQ0FBcUIsSUFBckIsRUFBMkI7QUFDekIsTUFBSSxTQUFTLEdBQUcsQ0FBaEI7QUFFQSxNQUFJLFFBQVEsR0FBRyxFQUFmOztBQUVBLFdBQVMsTUFBVCxHQUFrQjtBQUNoQixRQUFJLFlBQVksR0FBRyxJQUFJLENBQUMsR0FBTCxLQUFhLElBQWhDO0FBQ0EsSUFBQSxRQUFRLENBQUMsT0FBVCxDQUFpQixVQUFTLENBQVQsRUFBWTtBQUMzQixVQUFJLENBQUMsQ0FBQyxFQUFGLEdBQU8sWUFBWCxFQUF5QixJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUgsRUFBTSxDQUFDLENBQUMsQ0FBUixDQUFKO0FBQzFCLEtBRkQ7QUFHRDs7QUFFRCxFQUFBLFdBQVcsQ0FBQyxNQUFELEVBQVMsSUFBVCxDQUFYO0FBRUEsU0FBTztBQUNMLElBQUEsTUFBTSxFQUFFLE1BREg7QUFFTCxJQUFBLFFBQVEsRUFBRSxrQkFBUyxDQUFULEVBQVksQ0FBWixFQUFlO0FBQ3ZCLE1BQUEsQ0FBQyxDQUFDLENBQUYsR0FBTSxTQUFTLEVBQWY7QUFDQSxNQUFBLFFBQVEsQ0FBQyxJQUFULENBQWM7QUFDWixRQUFBLENBQUMsRUFBRSxDQURTO0FBRVosUUFBQSxDQUFDLEVBQUUsQ0FGUztBQUdaLFFBQUEsRUFBRSxFQUFFLElBQUksQ0FBQyxHQUFMO0FBSFEsT0FBZDtBQUtELEtBVEk7QUFVTCxJQUFBLE1BQU0sRUFBRSxnQkFBUyxFQUFULEVBQWE7QUFDbkIs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ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJpbXBvcnQgJy4vc3RhbmRhbG9uZXMvdXRpbCc7XG5pbXBvcnQgJy4vc3RhbmRhbG9uZXMvdHJhbnMnO1xuaW1wb3J0ICcuL3NvY2tldCc7XG5pbXBvcnQgJy4vbWFpbic7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIFxufSkoKTtcbiIsImZ1bmN0aW9uIG1ha2VBY2thYmxlKHNlbmQpIHtcbiAgdmFyIGN1cnJlbnRJZCA9IDE7XG5cbiAgdmFyIG1lc3NhZ2VzID0gW107XG5cbiAgZnVuY3Rpb24gcmVzZW5kKCkge1xuICAgIHZhciByZXNlbmRDdXRvZmYgPSBEYXRlLm5vdygpIC0gMjUwMDtcbiAgICBtZXNzYWdlcy5mb3JFYWNoKGZ1bmN0aW9uKG0pIHtcbiAgICAgIGlmIChtLmF0IDwgcmVzZW5kQ3V0b2ZmKSBzZW5kKG0udCwgbS5kKTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldEludGVydmFsKHJlc2VuZCwgMTAwMCk7XG5cbiAgcmV0dXJuIHtcbiAgICByZXNlbmQ6IHJlc2VuZCxcbiAgICByZWdpc3RlcjogZnVuY3Rpb24odCwgZCkge1xuICAgICAgZC5hID0gY3VycmVudElkKys7XG4gICAgICBtZXNzYWdlcy5wdXNoKHtcbiAgICAgICAgdDogdCxcbiAgICAgICAgZDogZCxcbiAgICAgICAgYXQ6IERhdGUubm93KClcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZ290QWNrOiBmdW5jdGlvbihpZCkge1xuICAgICAgbWVzc2FnZXMgPSBtZXNzYWdlcy5maWx0ZXIoZnVuY3Rpb24obSkge1xuICAgICAgICByZXR1cm4gbS5kLmEgIT09IGlkO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xufVxuXG5zdGFyLlN0cm9uZ1NvY2tldCA9IGZ1bmN0aW9uKHVybCwgdmVyc2lvbiwgc2V0dGluZ3MpIHtcbiAgdmFyIG5vdyA9IERhdGUubm93O1xuXG4gIHNldHRpbmdzID0gJC5leHRlbmQodHJ1ZSwge30sIHN0YXIuU3Ryb25nU29ja2V0LmRlZmF1bHRzLCBzZXR0aW5ncyk7XG4gIHZhciBvcHRpb25zID0gc2V0dGluZ3Mub3B0aW9ucztcbiAgdmFyIHdzO1xuICB2YXIgcGluZ1NjaGVkdWxlO1xuICB2YXIgY29ubmVjdFNjaGVkdWxlO1xuICB2YXIgYWNrYWJsZSA9IG1ha2VBY2thYmxlKGZ1bmN0aW9uKHQsIGQpeyBzZW5kKHQsIGQpOyB9KTtcbiAgdmFyIGxhc3RQaW5nVGltZSA9IG5vdygpO1xuICB2YXIgcG9uZ0NvdW50ID0gMDtcbiAgdmFyIGF2ZXJhZ2VMYWcgPSAwO1xuICB2YXIgdHJ5T3RoZXJVcmwgPSBmYWxzZTtcbiAgdmFyIGF1dG9SZWNvbm5lY3QgPSB0cnVlO1xuICB2YXIgbmJDb25uZWN0cyA9IDA7XG4gIHZhciBzdG9yYWdlID0gc3Rhci5zdG9yYWdlLm1ha2UoJ3N1cmw2Jyk7XG5cbiAgdmFyIGNvbm5lY3QgPSBmdW5jdGlvbigpIHtcbiAgICBkZXN0cm95KCk7XG4gICAgYXV0b1JlY29ubmVjdCA9IHRydWU7XG4gICAgdmFyIHBhcmFtcyA9ICQucGFyYW0oc2V0dGluZ3MucGFyYW1zKTtcbiAgICBpZiAodmVyc2lvbiAhPT0gZmFsc2UpIHBhcmFtcyArPSAocGFyYW1zID8gJyYnIDogJycpKyAndj0nICsgdmVyc2lvbjtcbiAgICB2YXIgZnVsbFVybCA9IG9wdGlvbnMucHJvdG9jb2wgKyAnLy8nICsgYmFzZVVybCgpICsgdXJsICsgJz8nICsgcGFyYW1zO1xuICAgIGRlYnVnKFwiY29ubmVjdGlvbiBhdHRlbXB0IHRvIFwiICsgZnVsbFVybCk7XG4gICAgdHJ5IHtcbiAgICAgIHdzID0gbmV3IFdlYlNvY2tldChmdWxsVXJsKTtcbiAgICAgIHdzLm9uZXJyb3IgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgIG9uRXJyb3IoZSk7XG4gICAgICB9O1xuICAgICAgd3Mub25jbG9zZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKGF1dG9SZWNvbm5lY3QpIHtcbiAgICAgICAgICBkZWJ1ZyhcIldpbGwgYXV0b3JlY29ubmVjdCBpbiBcIiArIG9wdGlvbnMuYXV0b1JlY29ubmVjdERlbGF5KTtcbiAgICAgICAgICBzY2hlZHVsZUNvbm5lY3Qob3B0aW9ucy5hdXRvUmVjb25lY3REZWxheSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICB3cy5vbm9wZW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgZGVidWcoXCJjb25uZWN0ZWQgdG8gXCIgKyBmdWxsVXJsKTtcbiAgICAgICAgb25TdWNjZXNzKCk7XG4gICAgICAgICQoXCJib2R5XCIpLnJlbW92ZUNsYXNzKFwib2ZmbGluZVwiKS5hZGRDbGFzcyhcIm9ubGluZVwiKTtcbiAgICAgICAgcGluZ05vdygpO1xuICAgICAgICBhY2thYmxlLnJlc2VuZCgpO1xuICAgICAgfTtcbiAgICAgIHdzLm9ubWVzc2FnZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgaWYgKGUuZGF0YSA9PT0gMCkgeyBwb25nKCk7IHJldHVybjsgfVxuICAgICAgICB2YXIgbSA9IEpTT04ucGFyc2UoZS5kYXRhKTtcbiAgICAgICAgaWYgKG0udCA9PT0gJ24nKSBwb25nKCk7XG4gICAgICAgIGlmIChtLnQgPT09ICdiJykgbS5kLmZvckVhY2goaGFuZGxlKTtcbiAgICAgICAgZWxzZSBoYW5kbGUobSk7XG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIG9uRXJyb3IoZSk7XG4gICAgfVxuICAgIHNjaGVkdWxlQ29ubmVjdChvcHRpb25zLnBpbmdNYXhMYWcpO1xuICB9O1xuXG4gIHZhciBzZW5kID0gZnVuY3Rpb24odCwgZCwgbywgbm9SZXRyeSkge1xuICAgIG8gPSBvIHx8IHt9O1xuICAgIHZhciBtc2cgPSB7IHQ6IHQgfTtcbiAgICBpZiAoZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAoby53aXRoTGFnKSBkLmwgPSBNYXRoLnJvdW5kKGF2ZXJhZ2VMYWcpO1xuICAgICAgaWYgKG8ubWlsbGlzID49IDApIGQucyA9IE1hdGgucm91bmQoby5taWxsaXMgKiAwLjEpLnRvU3RyaW5nKDM2KTtcbiAgICAgIG1zZy5kID0gZDtcbiAgICB9XG4gICAgaWYgKG8uYWNrYWJsZSkge1xuICAgICAgbXNnLmQgPSBtc2cuZCB8fCB7fTtcbiAgICAgIGFja2FibGUucmVnaXN0ZXIodCwgbXNnLmQpO1xuICAgIH1cbiAgICB2YXIgbWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KG1zZyk7XG4gICAgZGVidWcoXCJzZW5kIFwiICsgbWVzc2FnZSk7XG4gICAgdHJ5IHtcbiAgICAgIHdzLnNlbmQobWVzc2FnZSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgaWYgKCFub1JldHJ5KSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBzZW5kKHQsIG1zZy5kLCBvLCB0cnVlKTtcbiAgICAgIH0sIDEwMDApO1xuICAgIH1cbiAgfTtcblxuICB2YXIgc2NoZWR1bGVDb25uZWN0ID0gZnVuY3Rpb24oZGVsYXkpIHtcbiAgICBpZiAob3B0aW9ucy5pZGxlKSBkZWxheSA9IDEwICogMTAwMCArIE1hdGgucmFuZG9tKCkgKiAxMCAqIDEwMDA7XG4gICAgY2xlYXJUaW1lb3V0KHBpbmdTY2hlZHVsZSk7XG4gICAgY2xlYXJUaW1lb3V0KGNvbm5lY3RTY2hlZHVsZSk7XG4gICAgY29ubmVjdFNjaGVkdWxlID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnb2ZmbGluZScpLnJlbW92ZUNsYXNzKCdvbmxpbmUnKTtcbiAgICAgIHRyeU90aGVyVXJsID0gdHJ1ZTtcbiAgICAgIGNvbm5lY3QoKTtcbiAgICB9LCBkZWxheSk7XG4gIH07XG4gIHZhciBzY2hlZHVsZVBpbmcgPSBmdW5jdGlvbihkZWxheSkge1xuICAgIGNsZWFyVGltZW91dChwaW5nU2NoZWR1bGUpO1xuICAgIHBpbmdTY2hlZHVsZSA9IHNldFRpbWVvdXQocGluZ05vdywgZGVsYXkpO1xuICB9O1xuICB2YXIgcGluZ05vdyA9IGZ1bmN0aW9uKCkge1xuICAgIGNsZWFyVGltZW91dChwaW5nU2NoZWR1bGUpO1xuICAgIGNsZWFyVGltZW91dChjb25uZWN0U2NoZWR1bGUpO1xuICAgIHZhciBwaW5nRGF0YSA9IChvcHRpb25zLmlzQXV0aCAmJiBwb25nQ291bnQgJSA4ID09IDIpID8gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgdDogJ3AnLFxuICAgICAgbDogTWF0aC5yb3VuZCgwLjEgKiBhdmVyYWdlTGFnKSxcbiAgICAgIHY6IHZlcnNpb25cbiAgICB9KSA6IG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIHdzLnNlbmQocGluZ0RhdGEpO1xuICAgICAgbGFzdFBpbmdUaW1lID0gbm93KCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgZGVidWcoZSwgdHJ1ZSk7XG4gICAgfVxuICAgIHNjaGVkdWxlQ29ubmVjdChvcHRpb25zLnBpbmdNYXhMYWcpO1xuICB9O1xuICB2YXIgY29tcHV0ZVBpbmdEZWxheSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBvcHRpb25zLnBpbmdEZWxheSArIChvcHRpb25zLmlkbGUgPyAxMDAwIDogMCk7XG4gIH07XG4gIHZhciBwb25nID0gZnVuY3Rpb24oKSB7XG4gICAgY2xlYXJUaW1lb3V0KGNvbm5lY3RTY2hlZHVsZSk7XG4gICAgc2NoZWR1bGVQaW5nKGNvbXB1dGVQaW5nRGVsYXkoKSk7XG4gICAgdmFyIGN1cnJlbnRMYWcgPSBNYXRoLm1pbihub3coKSAtIGxhc3RQaW5nVGltZSwgMTAwMDApO1xuICAgIHBvbmdDb3VudCsrO1xuICAgIFxuICAgIHZhciBtaXggPSBwb25nQ291bnQgPiA0ID8gMC4xIDogMSAvIHBvbmdDb3VudDtcbiAgICBhdmVyYWdlTGFnICs9IG1peCAqIChjdXJyZW50TGFnIC0gYXZlcmFnZUxhZyk7XG4gIH07XG4gIHZhciBoYW5kbGUgPSBmdW5jdGlvbihtKSB7XG4gICAgaWYgKG0udikge1xuICAgICAgaWYgKG0udiA8PSB2ZXJzaW9uKSB7XG4gICAgICAgIGRlYnVnKFwiYWxyZWFkeSBoYXMgZXZlbnQgXCIgKyBtLnYpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAobS52ID4gdmVyc2lvbiArIDEpIHtcbiAgICAgICAgc3Rhci5yZWxvYWQoKTsgXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHZlcnNpb24gPSBtLnY7XG4gICAgfVxuICAgIHN3aXRjaChtLnQgfHwgZmFsc2UpIHtcbiAgICBjYXNlIGZhbHNlOlxuICAgICAgYnJlYWs7XG4gICAgY2FzZSAncmVzeW5jJzpcbiAgICAgIHN0YXIucmVsb2FkKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdhY2snOlxuICAgICAgYWNrYWJsZS5nb3RBY2sobS5kKTtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICB2YXIgcHJvY2Vzc2VkID0gc2V0dGluZ3MucmVjZWl2ZSAmJiBzZXR0aW5ncy5yZWNlaXZlKG0udCwgbS5kKTtcbiAgICAgIGlmICghcHJvY2Vzc2VkICYmIHNldHRpbmdzLmV2ZW50c1ttLnRdKSBzZXR0aW5ncy5ldmVudHNbbS50XShtLmQgfHwgbnVsbCwgbSk7XG4gICAgfVxuICB9O1xuICB2YXIgZGVidWcgPSBmdW5jdGlvbihtc2csIGFsd2F5cykge1xuICAgIGlmIChhbHdheXMgfHwgb3B0aW9ucy5kZWJ1Zykge1xuICAgICAgY29uc29sZS5kZWJ1ZyhcIltcIiArIG9wdGlvbnMubmFtZSArIFwiIFwiICsgc2V0dGluZ3MucGFyYW1zLnNyaSArIFwiXVwiLCBtc2cpO1xuICAgIH1cbiAgfTtcbiAgdmFyIGRlc3Ryb3kgPSBmdW5jdGlvbigpIHtcbiAgICBjbGVhclRpbWVvdXQocGluZ1NjaGVkdWxlKTtcbiAgICBjbGVhclRpbWVvdXQoY29ubmVjdFNjaGVkdWxlKTtcbiAgICBkaXNjb25uZWN0KCk7XG4gICAgd3MgPSBudWxsO1xuICB9O1xuICB2YXIgZGlzY29ubmVjdCA9IGZ1bmN0aW9uKG9uTmV4dENvbm5lY3QpIHtcbiAgICBpZiAod3MpIHtcbiAgICAgIGRlYnVnKFwiRGlzY29ubmVjdFwiKTtcbiAgICAgIGF1dG9SZWNvbm5lY3QgPSBmYWxzZTtcbiAgICAgIHdzLm9uZXJyb3IgPSB3cy5vbmNsb3NlID0gd3Mub25vcGVuID0gd3Mub25tZXNzYWdlID0gJC5ub29wO1xuICAgICAgd3MuY2xvc2UoKTtcbiAgICB9XG4gICAgaWYgKG9uTmV4dENvbm5lY3QpIG9wdGlvbnMub25OZXh0Q29ubmVjdCA9IG9uTmV4dENvbm5lY3Q7XG4gIH07XG4gIHZhciBvbkVycm9yID0gZnVuY3Rpb24oZSkge1xuICAgIG9wdGlvbnMuZGVidWcgPSB0cnVlO1xuICAgIGRlYnVnKCdlcnJvcjogJyArIEpTT04uc3RyaW5naWZ5KGUpKTtcbiAgICB0cnlPdGhlclVybCA9IHRydWU7XG4gICAgY2xlYXJUaW1lb3V0KHBpbmdTY2hlZHVsZSk7XG4gIH07XG4gIHZhciBvblN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICBuYkNvbm5lY3RzKys7XG4gICAgaWYgKG5iQ29ubmVjdHMgPT09IDEpIHtcbiAgICAgIG9wdGlvbnMub25GaXJzdENvbm5lY3QoKTtcbiAgICB9XG4gIH07XG4gIHZhciBiYXNlVXJsID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHVybHMgPSBvcHRpb25zLmJhc2VVcmxzLCB1cmwgPSBzdG9yYWdlLmdldCgpO1xuICAgIGlmICghdXJsKSB7XG4gICAgICB1cmwgPSB1cmxzWzBdO1xuICAgICAgc3RvcmFnZS5zZXQodXJsKTtcbiAgICB9IGVsc2UgaWYgKHRyeU90aGVyVXJsKSB7XG4gICAgICB0cnlPdGhlclVybCA9IGZhbHNlO1xuICAgICAgdXJsID0gdXJsc1sodXJscy5pbmRleE9mKHVybCkgKyAxKSAlIHVybHMubGVuZ3RoXTtcbiAgICAgIHN0b3JhZ2Uuc2V0KHVybCk7XG4gICAgfVxuICAgIHJldHVybiB1cmw7XG4gIH07XG5cbiAgY29ubmVjdCgpO1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndW5sb2FkJywgZGVzdHJveSk7XG5cbiAgcmV0dXJuIHtcbiAgICBjb25uZWN0LFxuICAgIGRpc2Nvbm5lY3QsXG4gICAgc2VuZCxcbiAgICBkZXN0cm95LFxuICAgIG9wdGlvbnMsXG4gICAgcGluZ0ludGVydmFsOiBmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBjb21wdXRlUGluZ0ludGVydmFsKCkgKyBhdmVyYWdlTGFnO1xuICAgIH0sXG4gICAgYXZlcmFnZUxhZzogZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gYXZlcmFnZUxhZztcbiAgICB9LFxuICAgIGdldFZlcnNpb246IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHZlcnNpb247XG4gICAgfVxuICB9O1xufTtcblxuc3Rhci5TdHJvbmdTb2NrZXQuc3JpID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMiwgMTIpO1xuXG5zdGFyLlN0cm9uZ1NvY2tldC5kZWZhdWx0cyA9IHtcbiAgZXZlbnRzOiB7XG4gIH0sXG4gIHBhcmFtczoge1xuICAgIHNyaTogc3Rhci5TdHJvbmdTb2NrZXQuc3JpXG4gIH0sXG4gIG9wdGlvbnM6IHtcbiAgICBuYW1lOiAndW5uYW1lZCcsXG4gICAgaWRsZTogZmFsc2UsXG4gICAgcGluZ01heExhZzogOTAwMCxcbiAgICBwaW5nRGVsYXk6IDI1MDAsXG4gICAgYXV0b1JlY29ubmVjdERlbGF5OiAzNTAwLFxuICAgIHByb3RvY29sOiBsb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicgPyAnd3NzOicgOiAnd3M6JyxcbiAgICBiYXNlVXJsczogKGZ1bmN0aW9uKGQpIHtcbiAgICAgIHJldHVybiBbZF0uY29uY2F0KChkID09PSAnc29ja2V0Lm95dW5rZXlmLm5ldCcgfHwgZCA9PT0gJ3NvY2tldC5vLmNvbScgPyBbMSwgMiwgNSwgNl0gOiBbXSkubWFwKGZ1bmN0aW9uKHBvcnQpIHtcbiAgICAgICAgcmV0dXJuIGQgKyAnOicgKyAoOTAyMCArIHBvcnQpO1xuICAgICAgfSkpO1xuICAgIH0pKGRvY3VtZW50LmJvZHkuZ2V0QXR0cmlidXRlKCdkYXRhLXNvY2tldC1kb21haW4nKSksXG4gICAgb25GaXJzdENvbm5lY3Q6ICQubm9vcFxuICB9XG59O1xuIiwic3Rhci50cmFucyA9IGZ1bmN0aW9uKGkxOG4pIHtcbiAgdmFyIGZvcm1hdCA9IGZ1bmN0aW9uKHN0ciwgYXJncykge1xuICAgIGlmIChhcmdzLmxlbmd0aCAmJiBzdHIuaW5jbHVkZXMoJyRzJykpXG4gICAgICBmb3IgKHZhciBpID0gMTsgaSA8IDQ7IGkrKylcbiAgICAgICAgc3RyID0gc3RyLnJlcGxhY2UoJyUnICsgaSArICckcycsIGFyZ3NbaSAtIDFdKTtcbiAgICBhcmdzLmZvckVhY2goZnVuY3Rpb24oYXJnKSB7XG4gICAgICBzdHIgPSBzdHIucmVwbGFjZSgnJXMnLCBhcmcpO1xuICAgIH0pO1xuICAgIHJldHVybiBzdHI7XG4gIH07XG4gIHZhciBsaXN0ID0gZnVuY3Rpb24oc3RyLCBhcmdzKSB7XG4gICAgdmFyIHNlZ21lbnRzID0gc3RyLnNwbGl0KC8oJSg/OlxcZFxcJCk/cykvZyk7XG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIHBvcyA9IHNlZ21lbnRzLmluZGV4T2YoJyUnICsgaSArICckcycpO1xuICAgICAgaWYgKHBvcyAhPT0gLTEpIHNlZ21lbnRzW3Bvc10gPSBhcmdzW2kgLSAxXTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgcG9zID0gc2VnbWVudHMuaW5kZXhPZignJXMnKTtcbiAgICAgIGlmIChwb3MgPT09IC0xKSBicmVhaztcbiAgICAgIHNlZ21lbnRzW3Bvc10gPSBhcmdzW2ldO1xuICAgIH1cbiAgICByZXR1cm4gc2VnbWVudHM7XG4gIH07XG5cbiAgdmFyIHRyYW5zID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgdmFyIHN0ciA9IGkxOG5ba2V5XTtcbiAgICByZXR1cm4gc3RyID8gZm9ybWF0KHN0ciwgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSkgOiBrZXk7XG4gIH07XG5cbiAgdHJhbnMubm9hcmcgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAvLyBvcHRpbWlzYXRpb24gZm9yIHRyYW5zbGF0aW9ucyB3aXRob3V0IGFyZ3VtZW50c1xuICAgIHJldHVybiBpMThuW2tleV0gfHwga2V5O1xuICB9O1xuICB0cmFucy52ZG9tID0gZnVuY3Rpb24oa2V5KSB7XG4gICAgdmFyIHN0ciA9IGkxOG5ba2V5XTtcbiAgICByZXR1cm4gc3RyID8gbGlzdChzdHIsIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpIDogW2tleV07XG4gIH07XG4gIHJldHVybiB0cmFucztcbn07XG4iLCJ3aW5kb3cuc3RhciA9IHdpbmRvdy5zdGFyIHx8IHt9O1xuXG5cbnN0YXIuc3RvcmFnZSA9IChmdW5jdGlvbigpIHtcbiAgdmFyIHN0b3JhZ2UgPSB3aW5kb3cubG9jYWxTdG9yYWdlO1xuICB2YXIgYXBpID0ge1xuICAgIGdldDogZnVuY3Rpb24oaykgeyByZXR1cm4gc3RvcmFnZS5nZXRJdGVtKGspOyB9LFxuICAgIHNldDogZnVuY3Rpb24oaywgdikgeyBzdG9yYWdlLnNldEl0ZW0oaywgdik7IH0sXG4gICAgcmVtb3ZlOiBmdW5jdGlvbihrKSB7IHN0b3JhZ2UucmVtb3ZlSXRlbShrKTsgfSxcbiAgICBtYWtlOiBmdW5jdGlvbihrKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gYXBpLmdldChrKTsgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbih2KSB7IGFwaS5zZXQoaywgdik7IH0sXG4gICAgICAgIHJlbW92ZTogZnVuY3Rpb24oKSB7IGFwaS5yZW1vdmUoayk7IH0sXG4gICAgICAgIGxpc3RlbjogZnVuY3Rpb24oZikge1xuICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzdG9yYWdlJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgaWYgKGUua2V5ID09PSBrICYmXG4gICAgICAgICAgICAgICAgZS5zdG9yYWdlQXJlYSA9PT0gc3RvcmFnZSAmJlxuICAgICAgICAgICAgICAgIGUubmV3VmFsdWUgIT09IG51bGwpIGYoZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9O1xuICByZXR1cm4gYXBpO1xufSkoKTtcbiJdfQ==
